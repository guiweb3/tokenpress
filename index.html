<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>TokenPress — Prensa cripto de nueva generación</title>
<link rel="icon" href="https://vpvsrjkotstvjywhuacr.supabase.co/storage/v1/object/public/logos/tokenpress.svg">
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--neon:#f72585;--neon2:#7209b7;--neon3:#3a0ca3;--bg:#050505;--surface:#0c0c0c;--surface2:#141414;--text:#e0e0e0;--dim:#555}
body{font-family:'Outfit',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden}
a{color:var(--neon);text-decoration:none}
::selection{background:var(--neon);color:#fff}

/* NOISE TEXTURE */
body::before{content:'';position:fixed;inset:0;background:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E");pointer-events:none;z-index:0}

/* HEADER */
.header{border-bottom:1px solid #1a1a1a;padding:1rem 2rem;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;background:rgba(5,5,5,.9);backdrop-filter:blur(20px);z-index:100}
.logo{display:flex;align-items:center;gap:12px}
.logo-mark{width:36px;height:36px;background:linear-gradient(135deg,var(--neon),var(--neon2));border-radius:2px;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:1.2rem;color:#fff}
.logo-text{font-family:'Space Mono',monospace;font-size:1.1rem;font-weight:700;letter-spacing:-0.5px}
.logo-text span{color:var(--neon)}
.header-right{display:flex;align-items:center;gap:1.5rem}
.search-input{background:var(--surface2);border:1px solid #222;padding:8px 16px;color:#fff;font-family:'Outfit',sans-serif;font-size:.8rem;width:200px;border-radius:0;transition:.2s}
.search-input:focus{outline:none;border-color:var(--neon);box-shadow:0 0 20px rgba(247,37,133,.1)}
.live-dot{width:8px;height:8px;background:var(--neon);border-radius:50%;animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.3}}

/* HERO - Glitch style */
.hero{max-width:1300px;margin:0 auto;padding:3rem 2rem;display:grid;grid-template-columns:1fr 1fr;gap:0;cursor:pointer}
.hero:hover .hero-title{text-shadow:3px 3px 0 var(--neon),-3px -3px 0 var(--neon2)}
.hero-left{padding:3rem;border:1px solid #1a1a1a;border-right:none;display:flex;flex-direction:column;justify-content:center}
.hero-tag{font-family:'Space Mono',monospace;font-size:.65rem;text-transform:uppercase;letter-spacing:3px;color:var(--neon);margin-bottom:1.5rem;display:flex;align-items:center;gap:8px}
.hero-tag::before{content:'';width:30px;height:1px;background:var(--neon)}
.hero-title{font-size:2.8rem;font-weight:800;line-height:1.1;margin-bottom:1rem;transition:text-shadow .3s}
.hero-excerpt{font-size:.95rem;line-height:1.7;color:var(--dim);font-weight:300}
.hero-meta{margin-top:1.5rem;font-family:'Space Mono',monospace;font-size:.7rem;color:var(--dim)}
.hero-right{border:1px solid #1a1a1a;background:linear-gradient(135deg,var(--neon3),var(--neon2));position:relative;min-height:350px;overflow:hidden}
.hero-right::after{content:'TOKEN\\APRESS';position:absolute;bottom:-20px;right:-10px;font-size:6rem;font-weight:800;color:rgba(255,255,255,.04);line-height:1;white-space:pre}
.hero-right .grid-overlay{position:absolute;inset:0;background-image:linear-gradient(rgba(255,255,255,.03) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,.03) 1px,transparent 1px);background-size:40px 40px}

/* STATS BAR */
.stats-bar{max-width:1300px;margin:0 auto;padding:0 2rem}
.stats-inner{display:flex;border:1px solid #1a1a1a;border-top:none}
.stat{flex:1;padding:1rem 1.5rem;border-right:1px solid #1a1a1a;font-family:'Space Mono',monospace}
.stat:last-child{border-right:none}
.stat-label{font-size:.6rem;text-transform:uppercase;letter-spacing:2px;color:var(--dim)}
.stat-value{font-size:1.1rem;font-weight:700;margin-top:4px}
.stat-value.up{color:#06d6a0}
.stat-value.down{color:var(--neon)}

/* FILTERS */
.filters{max-width:1300px;margin:2rem auto;padding:0 2rem;display:flex;gap:6px;flex-wrap:wrap}
.filter-btn{font-family:'Space Mono',monospace;font-size:.65rem;text-transform:uppercase;letter-spacing:1px;padding:8px 16px;border:1px solid #222;background:transparent;color:var(--dim);cursor:pointer;transition:.2s}
.filter-btn:hover,.filter-btn.active{border-color:var(--neon);color:var(--neon);box-shadow:0 0 15px rgba(247,37,133,.1)}

/* NEWS GRID - Brutalist cards */
.news-section{max-width:1300px;margin:0 auto;padding:0 2rem 3rem}
.news-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:0}
.news-card{border:1px solid #1a1a1a;padding:2rem;position:relative;cursor:pointer;transition:all .3s;overflow:hidden;margin:-0.5px}
.news-card::before{content:'';position:absolute;top:0;left:0;width:3px;height:0;background:linear-gradient(var(--neon),var(--neon2));transition:.3s}
.news-card:hover::before{height:100%}
.news-card:hover{background:var(--surface);border-color:#333}
.news-card .num{font-family:'Space Mono',monospace;font-size:.6rem;color:var(--dim);letter-spacing:2px;margin-bottom:1rem}
.news-card .cat{font-size:.6rem;text-transform:uppercase;letter-spacing:2px;color:var(--neon);margin-bottom:10px}
.news-card h3{font-size:1.15rem;font-weight:700;line-height:1.35;margin-bottom:10px;transition:.2s}
.news-card:hover h3{color:#fff}
.news-card .excerpt{font-size:.82rem;line-height:1.6;color:var(--dim);font-weight:300;margin-bottom:12px}
.news-card .tags{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:10px}
.news-card .tag{font-family:'Space Mono',monospace;font-size:.55rem;padding:3px 8px;border:1px solid #222;color:var(--dim)}
.news-card .meta{font-family:'Space Mono',monospace;font-size:.6rem;color:#333}

/* ARTICLE */
.article-view{display:none;max-width:720px;margin:0 auto;padding:3rem 2rem;position:relative;z-index:1}
.back-btn{font-family:'Space Mono',monospace;font-size:.7rem;text-transform:uppercase;letter-spacing:2px;color:var(--dim);cursor:pointer;margin-bottom:2rem;display:flex;align-items:center;gap:8px;transition:.2s}
.back-btn:hover{color:var(--neon)}
.back-btn::before{content:'←';color:var(--neon)}
.article-view h1{font-size:2.5rem;font-weight:800;line-height:1.15;margin-bottom:1rem}
.article-view .article-meta{font-family:'Space Mono',monospace;font-size:.7rem;color:var(--dim);letter-spacing:1px;margin-bottom:2rem;padding-bottom:1.5rem;border-bottom:1px solid #1a1a1a}
.article-view .article-body{font-size:1.05rem;line-height:1.85;color:#bbb;font-weight:300}
.article-view .article-body h2{font-size:1.5rem;font-weight:700;margin:2rem 0 1rem;color:#fff}
.article-view .article-body h3{font-size:1.15rem;margin:1.5rem 0 .8rem;color:#ddd}
.article-view .article-body p{margin-bottom:1.2rem}
.article-view .article-body strong{color:#fff;font-weight:600}
.article-view .article-body blockquote{border-left:2px solid var(--neon);padding:1rem 1.5rem;margin:1.5rem 0;color:var(--dim);background:var(--surface)}
.article-view .article-body ul,.article-view .article-body ol{margin:1rem 0 1rem 1.5rem}
.article-view .article-body li{margin-bottom:.5rem}

.loader{text-align:center;padding:4rem;font-family:'Space Mono',monospace;font-size:.85rem;color:var(--dim)}

@media(max-width:768px){
.hero{grid-template-columns:1fr}.hero-right{min-height:150px}
.hero-title{font-size:1.8rem}
.news-grid{grid-template-columns:1fr}
.stats-inner{flex-direction:column}
.stat{border-right:none;border-bottom:1px solid #1a1a1a}
}
</style>
</head>
<body>

<div class="header">
<div class="logo">
<img src="https://vpvsrjkotstvjywhuacr.supabase.co/storage/v1/object/public/logos/tokenpress.svg" alt="TokenPress" style="height:36px">
<div class="logo-text">Token<span>Press</span></div>
</div>
<div class="header-right">
<div class="live-dot"></div>
<input class="search-input" type="text" placeholder="search_" oninput="doSearch(this.value)">
</div>
</div>

<div id="mainView">
<div id="heroSection"></div>

<div class="stats-bar"><div class="stats-inner">
<div class="stat"><div class="stat-label">Artículos hoy</div><div class="stat-value" id="statCount">—</div></div>
<div class="stat"><div class="stat-label">Última actualización</div><div class="stat-value" id="statTime">—</div></div>
<div class="stat"><div class="stat-label">Categorías</div><div class="stat-value" id="statCats">—</div></div>
<div class="stat"><div class="stat-label">Fuente</div><div class="stat-value">EN VIVO</div></div>
</div></div>

<div class="filters" id="filters"></div>

<div class="news-section">
<div class="news-grid" id="newsGrid"></div>
</div>
</div>

<div class="article-view" id="articleView">
<div class="back-btn" onclick="goBack()">Volver</div>
<h1 id="artTitle"></h1>
<div class="article-meta" id="artMeta"></div>
<div class="article-body" id="artBody"></div>
</div>

<script>
const SUPABASE_URL='https://vpvsrjkotstvjywhuacr.supabase.co';
const SUPABASE_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZwdnNyamtvdHN0dmp5d2h1YWNyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDcyMzE2MzQsImV4cCI6MjA2MjgwNzYzNH0.BDh59N4okIoJB0aOheqp07lYLgd0A4y3Ho1H26xl2jw';
let allNews=[],currentFilter='',searchQuery='';
function parseTags(h){if(!h)return[];if(Array.isArray(h))return h;if(typeof h==='string')return h.split('#').filter(Boolean);return[]}

async function loadNews(){
const r=await fetch(`${SUPABASE_URL}/rest/v1/noticiasesp?status=eq.publicado&order=created_at.desc&limit=60`,
{headers:{'apikey':SUPABASE_KEY,'Authorization':`Bearer ${SUPABASE_KEY}`}});
allNews=await r.json();
document.getElementById('statCount').textContent=allNews.length;
if(allNews[0])document.getElementById('statTime').textContent=new Date(allNews[0].created_at).toLocaleTimeString('es-ES',{hour:'2-digit',minute:'2-digit'});
const cats=[...new Set(allNews.flatMap(n=>parseTags(n.hashtags)))];
document.getElementById('statCats').textContent=cats.length;
buildHero();buildFilters();renderNews();checkHash();
}

function buildHero(){
const el=document.getElementById('heroSection');
if(!allNews.length){el.innerHTML='<div class="loader">// awaiting_data...</div>';return}
const n=allNews[0];const cats=parseTags(n.hashtags).slice(0,2).map(h=>'#'+h).join(' ');
el.innerHTML=`<div class="hero" onclick="showArticle('${n.slug||n.id}')">
<div class="hero-left">
<div class="hero-tag">${cats}</div>
<div class="hero-title">${n.titulo_noticia}</div>
<div class="hero-excerpt">${(n.resumo_noticia||'').replace(/<[^>]*>/g,'').slice(0,200)}...</div>
<div class="hero-meta">// ${n.created_at?new Date(n.created_at).toLocaleDateString('es-ES',{day:'2-digit',month:'2-digit',year:'numeric'}):''}</div>
</div>
<div class="hero-right">${n.capa_noticia?`<img src="${n.capa_noticia}" style="width:100%;height:100%;object-fit:cover;position:absolute;inset:0;filter:saturate(.8)">`:''}<div class="grid-overlay"></div></div></div>`;
}

function buildFilters(){
const cats=[...new Set(allNews.flatMap(n=>parseTags(n.hashtags).slice(0,3)))].slice(0,10);
document.getElementById('filters').innerHTML='<div class="filter-btn active" onclick="setFilter(\'\')">ALL</div>'+
cats.map(c=>`<div class="filter-btn" onclick="setFilter('${c}')">${c}</div>`).join('');
}

function setFilter(f){currentFilter=f;document.querySelectorAll('.filter-btn').forEach(b=>b.classList.toggle('active',b.textContent===f||(f===''&&b.textContent==='ALL')));renderNews()}
function getFiltered(){let f=allNews;if(currentFilter)f=f.filter(n=>parseTags(n.hashtags).includes(currentFilter));if(searchQuery)f=f.filter(n=>(n.titulo_noticia||'').toLowerCase().includes(searchQuery)||(n.resumo_noticia||'').toLowerCase().includes(searchQuery));return f}

function renderNews(){
const f=getFiltered(),start=currentFilter||searchQuery?0:1;
document.getElementById('newsGrid').innerHTML=f.slice(start,30).map((n,i)=>{
const cats=parseTags(n.hashtags).slice(0,2).map(h=>'#'+h).join(' · ');
const tags=parseTags(n.hashtags).slice(0,3).map(h=>`<span class="tag">${h}</span>`).join('');
const date=n.created_at?new Date(n.created_at).toLocaleDateString('es-ES',{day:'2-digit',month:'2-digit'}):''
const img=n.capa_noticia?`<img src="${n.capa_noticia}" style="width:100%;height:160px;object-fit:cover;margin-bottom:1rem;filter:saturate(.8)">`:'';
return`<div class="news-card" onclick="showArticle('${n.slug||n.id}')">
${img}
<div class="num">${String(i+1).padStart(2,'0')}</div>
<div class="cat">${cats}</div>
<h3>${n.titulo_noticia}</h3>
<div class="excerpt">${(n.resumo_noticia||'').replace(/<[^>]*>/g,'').slice(0,130)}...</div>
<div class="tags">${tags}</div>
<div class="meta">// ${date}</div></div>`}).join('');
}

function parseMarkdown(md){if(!md)return'';return md.replace(/^### (.+)$/gm,'<h3>$1</h3>').replace(/^## (.+)$/gm,'<h2>$1</h2>').replace(/\*\*(.+?)\*\*/g,'<strong>$1</strong>').replace(/\*(.+?)\*/g,'<em>$1</em>').replace(/^> (.+)$/gm,'<blockquote>$1</blockquote>').replace(/^- (.+)$/gm,'<li>$1</li>').replace(/(<li>.*<\/li>)/gs,'<ul>$1</ul>').replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank">$1</a>').replace(/\n\n/g,'</p><p>').replace(/^/,'<p>').replace(/$/,'</p>')}

async function showArticle(slug){
let n=allNews.find(a=>(a.slug||a.id)==slug);
if(!n){const r=await fetch(`${SUPABASE_URL}/rest/v1/noticiasesp?slug=eq.${slug}&limit=1`,{headers:{'apikey':SUPABASE_KEY,'Authorization':`Bearer ${SUPABASE_KEY}`}});const d=await r.json();if(d.length)n=d[0]}
if(!n)return;
document.getElementById('artTitle').textContent=n.titulo_noticia;
document.getElementById('artMeta').innerHTML=`${n.created_at?new Date(n.created_at).toLocaleDateString('es-ES',{weekday:'long',day:'numeric',month:'long',year:'numeric'}):''} · ${parseTags(n.hashtags).map(h=>'<span style="color:var(--neon)">#'+h+'</span>').join(' ')}`;
const artImg=n.capa_noticia?`<img src="${n.capa_noticia}" style="width:100%;max-height:400px;object-fit:cover;margin-bottom:2rem;filter:saturate(.8)">`:'';document.getElementById('artBody').innerHTML=artImg+parseMarkdown(n.corpo_noticia||n.resumo_noticia||'');
document.getElementById('mainView').style.display='none';document.getElementById('articleView').style.display='block';
location.hash='/article/'+slug;window.scrollTo(0,0);
}
function goBack(){document.getElementById('mainView').style.display='';document.getElementById('articleView').style.display='none';location.hash=''}
function doSearch(q){searchQuery=q.toLowerCase();renderNews()}
function checkHash(){const h=location.hash;if(h.startsWith('#/article/'))showArticle(h.replace('#/article/',''))}
window.addEventListener('hashchange',checkHash);
loadNews();
</script>
</body>
</html>
